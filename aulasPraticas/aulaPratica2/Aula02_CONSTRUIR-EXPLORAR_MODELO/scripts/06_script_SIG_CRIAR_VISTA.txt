--#############
--# GRUPO 04
--#############




--=============
-- Liga��o � BD
--=============
\set dataBase my_gis
;
\set userName postgres
;
\connect :dataBase :userName
;
--==========================
--==========================


-- mais informa��o sobre "client_encoding" em:
-- http://www.postgresql.org/docs/9.4/static/multibyte.html
\encoding UTF8
;




--=========================================
-- Quais os infant�rios de cada freguesia ?
--=========================================
-- Atencao: a vista deve projectar o atributo "oid" ou uma chave prim�ria
--          do tipo "integer" de modo a ser apresentada no QGis
--=======================================================================

DROP VIEW IF EXISTS v_inf_frg;

SELECT I.lucro, FRG.nome, FRG.area
FROM infantario AS I,
(
    SELECT nome, ST_Area(F.local) AS area , F.local AS f_local
    FROM freguesia AS F
) AS FRG(nome, area, f_local)
-- WHERE ST_Within( I.local, FRG.f_local ) = true
;

-- SELECT nome_infantario, nome_freguesia_residencia, nome_freguesia_infantario, ST_AsText( g_local_cliente )
-- FROM v_inf_frg;
;
